(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[5829],{3905:function(e,t,n){"use strict";n.d(t,{Zo:function(){return p},kt:function(){return m}});var o=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,o)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function s(e,t){if(null==e)return{};var n,o,r=function(e,t){if(null==e)return{};var n,o,r={},a=Object.keys(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(o=0;o<a.length;o++)n=a[o],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var l=o.createContext({}),u=function(e){var t=o.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},p=function(e){var t=u(e.components);return o.createElement(l.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return o.createElement(o.Fragment,{},t)}},c=o.forwardRef((function(e,t){var n=e.components,r=e.mdxType,a=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),c=u(n),m=r,h=c["".concat(l,".").concat(m)]||c[m]||d[m]||a;return n?o.createElement(h,i(i({ref:t},p),{},{components:n})):o.createElement(h,i({ref:t},p))}));function m(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var a=n.length,i=new Array(a);i[0]=c;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:r,i[1]=s;for(var u=2;u<a;u++)i[u]=n[u];return o.createElement.apply(null,i)}return o.createElement.apply(null,n)}c.displayName="MDXCreateElement"},4508:function(e,t,n){"use strict";n.d(t,{p:function(){return r}});var o=n(7294),r=function(){var e=(0,o.useRef)(null),t=(0,o.useCallback)((function(){var t;null==(t=e.current)||t.classList.toggle("transparent")}),[]);return o.createElement("div",null,o.createElement("video",{ref:e,src:"/img/transparent-video.webm",controls:!0,autoPlay:!0,loop:!0}),o.createElement("p",{className:"tr-centered",onClick:t},o.createElement("button",null,"Toggle transparency")))}},1664:function(e,t,n){"use strict";n.r(t),n.d(t,{frontMatter:function(){return s},metadata:function(){return l},toc:function(){return u},default:function(){return d}});var o=n(2122),r=n(9756),a=(n(7294),n(3905)),i=n(4508),s={slug:"1-4",title:"Remotion 1.4",author:"Jonny Burger",author_title:"Indie Hacker",author_url:"https://github.com/JonnyBurger",author_image_url:"https://avatars2.githubusercontent.com/u/1629785?s=460&u=12eb94da6070d00fc924761ce06e3a428d01b7e9&v=4"},l={permalink:"/blog/1-4",editUrl:"https://github.com/Jonnyburger/remotion/edit/main/packages/docs/blog/blog/2021-02-26-remotion-1-4.md",source:"@site/blog/2021-02-26-remotion-1-4.md",title:"Remotion 1.4",description:"Welcome to the release notes of Remotion 1.4! This is a big release adding support for more use cases and makes Remotion more stable, intuitive and robust.",date:"2021-02-26T00:00:00.000Z",formattedDate:"February 26, 2021",tags:[],readingTime:5.915,truncated:!1,prevItem:{title:"Remotion 1.5",permalink:"/blog/1-5"},nextItem:{title:"Remotion 1.3",permalink:"/blog/1-3"}},u=[{value:"Support for HEVC and WebM codecs",id:"support-for-hevc-and-webm-codecs",children:[]},{value:"Transparent videos",id:"transparent-videos",children:[]},{value:"New <code>random()</code> API",id:"new-random-api",children:[]},{value:"More configuration options",id:"more-configuration-options",children:[]},{value:"Keyboard controls in the editor",id:"keyboard-controls-in-the-editor",children:[]},{value:"Progress bar for stitching frames together",id:"progress-bar-for-stitching-frames-together",children:[]},{value:"New <code>layout</code> prop for <code>&lt;Sequence&gt;</code>",id:"new-layout-prop-for-sequence",children:[]},{value:"Asynchronously determining composition metadata",id:"asynchronously-determining-composition-metadata",children:[]},{value:"End to End tests for Windows, macOS and Ubuntu",id:"end-to-end-tests-for-windows-macos-and-ubuntu",children:[]},{value:"ESLint rule for wrong asset import",id:"eslint-rule-for-wrong-asset-import",children:[]},{value:"Paying top contributors",id:"paying-top-contributors",children:[]},{value:"Various improvements",id:"various-improvements",children:[]},{value:"Up next...",id:"up-next",children:[]}],p={toc:u};function d(e){var t=e.components,s=(0,r.Z)(e,["components"]);return(0,a.kt)("wrapper",(0,o.Z)({},p,s,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Welcome to the release notes of Remotion 1.4! This is a big release adding support for more use cases and makes Remotion more stable, intuitive and robust."),(0,a.kt)("h2",{id:"support-for-hevc-and-webm-codecs"},"Support for HEVC and WebM codecs"),(0,a.kt)("p",null,"Instead of just supporting H.264, you can now also encode a video in H.265 (HEVC), or as a WebM (in either VP8 or VP9 codec). These codecs will result in smaller file sizes, but have some trade-offs. To help you decide which codec to use, there is now an ",(0,a.kt)("a",{parentName:"p",href:"/docs/encoding"},"encoding guide")," in the docs. See also the\ndocumentation for changing the codec in ",(0,a.kt)("a",{parentName:"p",href:"/docs/config#setcodec"},"the config file"),"\nas well as ",(0,a.kt)("a",{parentName:"p",href:"/docs/cli#flags"},"in the CLI"),"."),(0,a.kt)("h2",{id:"transparent-videos"},"Transparent videos"),(0,a.kt)("p",null,"Did you know that Chrome and Firefox support video with alpha channels? Play the video and click the button below to dynamically change the background."),(0,a.kt)(i.p,{mdxType:"TransparentVideoDemo"}),(0,a.kt)("p",null,"Remotion now has enough configurability to enable you to render transparent videos. There is ",(0,a.kt)("a",{parentName:"p",href:"/docs/transparent-videos"},"a new documentation page")," for it, which also gives you guidance on how to render a fallback video for unsupported browsers."),(0,a.kt)("h2",{id:"new-random-api"},"New ",(0,a.kt)("inlineCode",{parentName:"h2"},"random()")," API"),(0,a.kt)("p",null,"Let's say you want to render 100 random particles in a video. A common mistake is to generate random values and store them in a state. The following is an anti-pattern in Remotion:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"{5-6}","{5-6}":!0},"export const MyComp = () => {\n  // \u26a0\ufe0f Bug! Random values will change during render\n  const [particles] = useState(() => {\n    return new Array(100).fill(true).map(() => ({\n      x: Math.random(),\n      y: Math.random()\n    }));\n  })\n}\n")),(0,a.kt)("p",null,"While this will work while previewing the video, during rendering, the random numbers will change during frames. This is because Remotion spins up multiple instances of Chrome and the random numbers will be different in each instance."),(0,a.kt)("p",null,"To help you avoid this mistake, there is now a new ESLint rule that will warn when you use ",(0,a.kt)("inlineCode",{parentName:"p"},"Math.random()"),". Instead using it, you can use the new ",(0,a.kt)("a",{parentName:"p",href:"/docs/random"},(0,a.kt)("inlineCode",{parentName:"a"},"random()"))," API. It will take a ",(0,a.kt)("inlineCode",{parentName:"p"},"seed")," parameter and output a number between 0 and 1. The point of it is: As long as you pass the same seed, you get the same output! That way you don't get unintended effects while multithreaded rendering is performed."),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx",metastring:"{7-8}","{7-8}":!0},"import {random} from 'remotion';\n\nexport const MyComp = () => {\n  // \u2705 Pseudo-random values that will be same across threads\n  const [particles] = useState(() => {\n    return new Array(100).fill(true).map((_, idx) => ({\n      x: random(`x-${idx}`),\n      y: random(`y-${idx}`),\n    }));\n  })\n}\n")),(0,a.kt)("p",null,"Want to learn more? Read the new documentation page about ",(0,a.kt)("a",{parentName:"p",href:"/docs/using-randomness"},"using randomness"),"."),(0,a.kt)("h2",{id:"more-configuration-options"},"More configuration options"),(0,a.kt)("p",null,"Several new configuration options have been added as CLI flags, config file entries and to the SSR API:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/docs/encoding#controlling-quality-using-the-crf-setting"},"setCrf()")," controls the tradeoff between quality and file size of the output file."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/docs/config#setquality"},"setQuality()")," allows you to control the JPEG quality of the frames rendered."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/docs/config#setcodec"},"setCodec()")," allows you to select between 4 different codecs (as mentioned above)."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/docs/config#setimagesequence"},"setImageSequence()")," allows you to skip the stitching process and output only an image sequence"),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/docs/config#setimageformat"},"setImageFormat()")," allows you to explicitly select either PNG or JPEG as the format for the rendered frames."),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("a",{parentName:"li",href:"/docs/config#setpixelformat"},"setPixelFormat()")," has a new accepted value, ",(0,a.kt)("inlineCode",{parentName:"li"},"yuva420p"),", which is necessary for transparent videos.")),(0,a.kt)("p",null,"The addition of ",(0,a.kt)("inlineCode",{parentName:"p"},"setImageSequence()")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"setImageFormat()")," as well as ",(0,a.kt)("inlineCode",{parentName:"p"},"setCodec()")," makes the previous configuration options ",(0,a.kt)("inlineCode",{parentName:"p"},"setOutputFormat()")," and ",(0,a.kt)("inlineCode",{parentName:"p"},"--png")," obsolete. and they are therefore now deprecated. While they still work, we encourage you to use the new configuration options which are much more granular - for example now you can render a JPEG sequence if you wish to."),(0,a.kt)("h2",{id:"keyboard-controls-in-the-editor"},"Keyboard controls in the editor"),(0,a.kt)("p",null,"Thanks to an ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/arthurdenner"},"awesome pull request by Arthur Denner"),", keyboard navigation in the editor is much improved! ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/JonnyBurger/remotion/pull/125"},"Reading the PR")," is highly recommended because it's insightful and makes you realize that it's not hard to make a website keyboard-navigateable."),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"keyboard-support.gif",src:n(1197).Z})),(0,a.kt)("h2",{id:"progress-bar-for-stitching-frames-together"},"Progress bar for stitching frames together"),(0,a.kt)("p",null,"Don't be surprised if the newly added codecs are much slower than the default H.264. It's normal. But at least now you can always check the progress of the rendering!"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"stitching-progress.png",src:n(4816).Z})),(0,a.kt)("h2",{id:"new-layout-prop-for-sequence"},"New ",(0,a.kt)("inlineCode",{parentName:"h2"},"layout")," prop for ",(0,a.kt)("inlineCode",{parentName:"h2"},"<Sequence>")),(0,a.kt)("p",null,"Few people have rightly pointed out that the ",(0,a.kt)("inlineCode",{parentName:"p"},"<Sequence>")," component will absolutely position it's children and there is no way to opt out of it. While we cannot change this now because of backwards-compatibility, you can now pass ",(0,a.kt)("inlineCode",{parentName:"p"},'layout="none"')," as a prop to opt out of any layout influence that ",(0,a.kt)("inlineCode",{parentName:"p"},"<Sequence>")," has."),(0,a.kt)("h2",{id:"asynchronously-determining-composition-metadata"},"Asynchronously determining composition metadata"),(0,a.kt)("p",null,"There's a small breaking change in this release - ",(0,a.kt)("inlineCode",{parentName:"p"},"delayRender")," works during the 'evaluation' phase. This is the phase where Remotion analyses your project and determines all compositions and does some validation. Watch out for ",(0,a.kt)("inlineCode",{parentName:"p"},"delayRender()")," calls outside components, as they might block the evaluation phase now since no components are being rendered during that phase."),(0,a.kt)("p",null,"The benefit is that now your compositions can take in data that has been asynchronously fetched. For example the following is now possible:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},'export const RemotionVideo: React.FC = () => {\n  const [videoLength, setVideoLength] = useState(null)\n\n  useEffect(() => {\n    const handle = delayRender();\n\n    determineVideoLength()\n    .then((duration) => {\n      setVideoLength(duration)\n      continueRender(handle)\n    })\n    .catch(err => /**/)\n  }, [])\n\n  if (videoLength === null) {\n    return null;\n  }\n\n  return (\n    <>\n      <Composition\n        id="HelloWorld"\n        component={HelloWorld}\n        durationInFrames={videoLength}\n        fps={30}\n        width={1920}\n        height={1080}\n      />\n    </>\n  )\n}\n')),(0,a.kt)("p",null,"Stay tuned for a new API that will allow you to measure video and audio duration!"),(0,a.kt)("h2",{id:"end-to-end-tests-for-windows-macos-and-ubuntu"},"End to End tests for Windows, macOS and Ubuntu"),(0,a.kt)("p",null,"While Remotion is primarily developed on macOS, other operating systems shouldn't have a sub-par experience or get bugs. While it does not replace manual testing, it helps that ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/JonnyBurger/remotion/blob/main/tests/rendering.test.ts"},"there are now some end-to-end tests for rendering videos")," and the test suite now runs on all 3 operating systems. Going forward, I will add more tests and contributors are also encouraged to do so."),(0,a.kt)("h2",{id:"eslint-rule-for-wrong-asset-import"},"ESLint rule for wrong asset import"),(0,a.kt)("p",null,"In Remotion, you shouldn't specify the ",(0,a.kt)("inlineCode",{parentName:"p"},"src")," as filepath string, but import the asset instead. To help you not make this mistake, there's a new ESLint rule:"),(0,a.kt)("pre",null,(0,a.kt)("code",{parentName:"pre",className:"language-tsx"},"import {Img} from 'remotion';\nimport hi from './hi.png';\n\n// \u2705 Correct: Using an import statement\n<Img src={hi} />\n\n// \u26a0\ufe0f Warning since 1.4: Import the asset instead\n<Img src=\"./hi.png\"/>\n")),(0,a.kt)("h2",{id:"paying-top-contributors"},"Paying top contributors"),(0,a.kt)("p",null,"Since Remotion ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/JonnyBurger/remotion/blob/main/LICENSE.md"},"will make money by selling licenses to bigger companies"),", it's only fair to give contributors their share as well! I have made offers to two top contributors so far to compensate them for their time spent so far and for potential future work. Gladly, they both accepted!"),(0,a.kt)("h2",{id:"various-improvements"},"Various improvements"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://github.com/JonnyBurger/remotion/pull/122"},"Fixed showing floats when fps is not a Integer (e.g 59.97fps)"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://github.com/JonnyBurger/remotion/pull/117"},"Ensure minimum node version"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://github.com/JonnyBurger/remotion/pull/118"},"Fix flickering ",(0,a.kt)("inlineCode",{parentName:"a"},"<Video>")))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://github.com/JonnyBurger/remotion/pull/127"},"Clean up frames after rendering"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://github.com/JonnyBurger/remotion/pull/130"},"Throw error if useVideoConfig is not used in Composition"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://github.com/JonnyBurger/remotion/pull/144"},"Don't timeout if image fails to load"))),(0,a.kt)("li",{parentName:"ul"},(0,a.kt)("p",{parentName:"li"},(0,a.kt)("a",{parentName:"p",href:"https://github.com/JonnyBurger/remotion/pull/146"},"Runtime error if you miss a prop in ",(0,a.kt)("inlineCode",{parentName:"a"},"<Composition>")," or ",(0,a.kt)("inlineCode",{parentName:"a"},"<Sequence>"))))),(0,a.kt)("h2",{id:"up-next"},"Up next..."),(0,a.kt)("p",null,"Some awesome pull requests came in, ",(0,a.kt)("a",{parentName:"p",href:"https://github.com/JonnyBurger/remotion/pull/128"},"the most notable one adds audio support!")," We are also working on allowing you to customize Puppeteer parameters and making the installation process much faster by not downloading a copy of Chromium. Keep your eyes open for more major improvements coming soon."))}d.isMDXComponent=!0},1197:function(e,t,n){"use strict";t.Z=n.p+"assets/images/keyboard-support-3a3be889caac7cae64489ba2a4303d41.gif"},4816:function(e,t,n){"use strict";t.Z=n.p+"assets/images/stitching-progress-1d02620869b969ffd36e67186210b340.png"}}]);